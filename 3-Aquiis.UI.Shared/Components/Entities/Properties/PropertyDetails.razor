@namespace Aquiis.UI.Shared.Components.Entities.Properties
@using Aquiis.Core.Entities
@using Aquiis.Core.Constants

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center @HeaderCssClass">
        <h5 class="mb-0">Property Information</h5>
        <span class="badge @GetAvailabilityBadgeClass()">
            @(Property.IsAvailable ? "Available" : "Occupied")
        </span>
        @if (OnEdit.HasDelegate)
        {
            <button class="btn btn-sm btn-outline-primary" @onclick="OnEdit">
                <i class="bi bi-pencil-square"></i> Edit
            </button>
        }
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-12 mb-3">
                <strong>Address:</strong>
                <p class="mb-1">@Property.Address @(!string.IsNullOrWhiteSpace(Property.UnitNumber) ? $", {Property.UnitNumber}" : "")</p>
                <small class="text-muted">@Property.City, @Property.State @Property.ZipCode</small>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <strong>Property Type:</strong>
                <p>@Property.PropertyType</p>
            </div>
            <div class="col-md-6 mb-3">
                <strong>Monthly Rent:</strong>
                <p class="text-success fw-bold">@Property.MonthlyRent.ToString("C")</p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <strong>Bedrooms:</strong>
                <p>@Property.Bedrooms</p>
            </div>
            <div class="col-md-4 mb-3">
                <strong>Bathrooms:</strong>
                <p>@Property.Bathrooms</p>
            </div>
            <div class="col-md-4 mb-3">
                <strong>Square Feet:</strong>
                <p>@Property.SquareFeet.ToString("N0")</p>
            </div>
        </div>

        @if (!string.IsNullOrEmpty(Property.Description))
        {
            <div class="row">
                <div class="col-md-12 mb-3">
                    <strong>Description:</strong>
                    <p>@Property.Description</p>
                </div>
            </div>
        }

        @if (ShowDates)
        {
            <div class="row">
                <div class="col-md-6 mb-3">
                    <strong>Created:</strong>
                    <p>@Property.CreatedOn.ToString("MMMM dd, yyyy")</p>
                </div>
                @if (Property.LastModifiedOn.HasValue)
                {
                    <div class="col-md-6 mb-3">
                        <strong>Last Modified:</strong>
                        <p>@Property.LastModifiedOn.Value.ToString("MMMM dd, yyyy")</p>
                    </div>
                }
            </div>
        }
    </div>
</div>

@code {
    /// <summary>
    /// Property entity to display
    /// </summary>
    [Parameter, EditorRequired]
    public Property Property { get; set; } = default!;

    [Parameter]
    public EventCallback OnEdit { get; set; }

    [Parameter]
    public string HeaderCssClass { get; set; } = "";
    
    /// <summary>
    /// Whether to show created/modified dates
    /// </summary>
    [Parameter]
    public bool ShowDates { get; set; } = true;
    
    private string GetAvailabilityBadgeClass()
    {
        return Property.IsAvailable ? "bg-success" : "bg-warning";
    }
}
